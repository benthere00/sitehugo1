<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Auto Generating Backup Files for your Linux Server - DataCarePH</title><meta name=Description content="Auto Generating Backup Files for your Linux Server"><meta property="og:title" content="Auto Generating Backup Files for your Linux Server"><meta property="og:description" content="Auto Generating Backup Files for your Linux Server"><meta property="og:type" content="article"><meta property="og:url" content="https://www.datacareph.com/blog/posts/automatically-backup-files-your-server-files/"><meta property="og:image" content="https://www.datacareph.com/blog/posts/automatically-backup-files-your-server-files/featured-image.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-03-13T11:57:40+08:00"><meta property="article:modified_time" content="2023-03-13T11:57:40+08:00"><meta property="og:site_name" content="DataCarePH"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.datacareph.com/blog/posts/automatically-backup-files-your-server-files/featured-image.png"><meta name=twitter:title content="Auto Generating Backup Files for your Linux Server"><meta name=twitter:description content="Auto Generating Backup Files for your Linux Server"><meta name=application-name content="DataCarePH"><meta name=apple-mobile-web-app-title content="DataCarePH"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=https://www.datacareph.com/blog/favicon.ico><link rel=icon type=image/png sizes=32x32 href=https://www.datacareph.com/blog/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://www.datacareph.com/blog/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=https://www.datacareph.com/blog/apple-touch-icon.png><link rel=mask-icon href=https://www.datacareph.com/blog/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=https://www.datacareph.com/blog/site.webmanifest><link rel=canonical href=https://www.datacareph.com/blog/posts/automatically-backup-files-your-server-files/><link rel=prev href=https://www.datacareph.com/blog/posts/breach-threat-someone-can-peek-your-saved-password-from-the-browser/><link rel=next href=https://www.datacareph.com/blog/posts/redirects-non-www-to-www-using-cloudflare/><link rel=stylesheet href=/blog/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Auto Generating Backup Files for your Linux Server","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/www.datacareph.com\/blog\/posts\/automatically-backup-files-your-server-files\/"},"image":[{"@type":"ImageObject","url":"https:\/\/www.datacareph.com\/blog\/posts\/automatically-backup-files-your-server-files\/featured-image.png","width":911,"height":564}],"genre":"posts","keywords":"linux, server, backup, bash","wordcount":1078,"url":"https:\/\/www.datacareph.com\/blog\/posts\/automatically-backup-files-your-server-files\/","datePublished":"2023-03-13T11:57:40+08:00","dateModified":"2023-03-13T11:57:40+08:00","license":"Research, News, and Blog - DataCarePH","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"venven"},"description":"Auto Generating Backup Files for your Linux Server"}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=https://www.datacareph.com/ title=DataCarePH><img class="lazyload logo" src=/blog/svg/loading.min.svg data-src=https://www.datacareph.com/blog/android-chrome-192x192.png data-srcset="https://www.datacareph.com/blog/android-chrome-192x192.png, https://www.datacareph.com/blog/android-chrome-192x192.png 1.5x, https://www.datacareph.com/blog/android-chrome-192x192.png 2x" data-sizes=auto alt=https://www.datacareph.com/blog/android-chrome-192x192.png title=https://www.datacareph.com/blog/android-chrome-192x192.png>DataCarePh</a></div><div class=menu><div class=menu-inner><a class=menu-item href=https://www.datacareph.com/>Home</a>
<a class=menu-item href=https://www.datacareph.com/blog>Blog</a>
<a class=menu-item href=/blog/posts/>Articles</a>
<a class=menu-item href=/blog/tags/>Tags</a>
<a class=menu-item href=/blog/categories/>Topics</a>
<a class=menu-item href=https://www.datacareph.com/contact>Contact </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="menu-item language" title="Select Language"><i class="fa fa-globe" aria-hidden=true></i>
<select class=language-select id=language-select-desktop onchange="location=this.value"><option value=/blog/posts/automatically-backup-files-your-server-files/ selected>English</option></select></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=https://www.datacareph.com title=DataCarePH><img class="lazyload logo" src=/blog/svg/loading.min.svg data-src=https://www.datacareph.com/blog/android-chrome-192x192.png data-srcset="https://www.datacareph.com/blog/android-chrome-192x192.png, https://www.datacareph.com/blog/android-chrome-192x192.png 1.5x, https://www.datacareph.com/blog/android-chrome-192x192.png 2x" data-sizes=auto alt=https://www.datacareph.com/blog/android-chrome-192x192.png title=https://www.datacareph.com/blog/android-chrome-192x192.png>DataCarePh</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=https://www.datacareph.com/ title>Home</a><a class=menu-item href=https://www.datacareph.com/blog title>Blog</a><a class=menu-item href=/blog/posts/ title>Articles</a><a class=menu-item href=/blog/tags/ title>Tags</a><a class=menu-item href=/blog/categories/ title>Topics</a><a class=menu-item href=https://www.datacareph.com/contact title>Contact</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class=menu-item title="Select Language"><i class="fa fa-globe fa-fw" aria-hidden=true></i>
<select class=language-select onchange="location=this.value"><option value=/blog/posts/automatically-backup-files-your-server-files/ selected>English</option></select></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><div class=toc-title>Contents</div><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Auto Generating Backup Files for your Linux Server</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://www.datacareph.com title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>venven</a></span>&nbsp;<span class=post-category>included in <a href=/blog/categories/automation/><i class="far fa-folder fa-fw" aria-hidden=true></i>Automation</a>&nbsp;<a href=/blog/categories/linux/><i class="far fa-folder fa-fw" aria-hidden=true></i>Linux</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2023-03-13>2023-03-13</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;1078 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;6 minutes&nbsp;</div></div><div class=featured-image></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#prerequisite>Prerequisite</a></li><li><a href=#how-back-up-script-works>How Back-up Script works?</a></li><li><a href=#the-bash-code>The Bash Code</a></li><li><a href=#executing-the-backup-script>Executing the Backup Script</a><ul><li><a href=#automation>Automation</a></li><li><a href=#manually-situational>Manually (Situational)</a></li></ul></li><li><a href=#recommendations>Recommendations</a></li><li><a href=#disclaimer>Disclaimer</a></li></ul></nav></div></div><div class=content id=content><p>source image: pexel.com</p><p>When doing computer work, clicking “save” is necessary to either literally or not literally save your job. This content is helpful when you are working on the Linux Operating System (OS), especially running a server. Automatically backing up your server can cost you money on a monthly basis and, of course, can save your business.</p><p>Just imagine how much of your time and effort goes to waste when you forget or have the tardiness to just press <code>ctrl + s</code> on your office application. Without further ado, let’s get started.</p><h2 id=prerequisite>Prerequisite</h2><p>Things you need before you proceed:</p><ul><li>Computer running Linux Operating System</li><li>SSH to access Linux OS Server (situational)</li><li>Free storage enough to save your work</li><li>nano, vim, or your favorite text editor</li><li>Cronjob <code>crontab -e</code></li></ul><p>This is a <code>bash</code> script dependencies are to follow:</p><ul><li>tar</li><li>tee</li><li>head</li><li>xargs</li><li>gzip</li></ul><p>If some bash commands are not natively installed, just i.e. <code>sudo apt install gzip</code> in the terminal.</p><h2 id=how-back-up-script-works>How Back-up Script works?</h2><p>This automation is using a <code>crontab</code>. Let’s say you have two folders in the tree (for simplicity).</p><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=/blog/posts/automatically-backup-files-your-server-files/backup-folder.png data-srcset="/blog/posts/automatically-backup-files-your-server-files/backup-folder.png, /blog/posts/automatically-backup-files-your-server-files/backup-folder.png 1.5x, /blog/posts/automatically-backup-files-your-server-files/backup-folder.png 2x" data-sizes=auto alt=/blog/posts/automatically-backup-files-your-server-files/backup-folder.png title=/blog/posts/automatically-backup-files-your-server-files/backup-folder.png width=640 height=360></p><p>– OR –</p><p>Visually..</p><ul><li>Backup -The folder where all your backups go</li><li>Documents – The folder where all your important files are saved i.e. web files, office files.</li><li>backup-script.sh – an executable bash file</li></ul><p>Basically, this script creates an archive file (named filename.tar.gz) of <code>Documents</code> folder and automatically saves it to <code>Backup</code> folder.</p><h2 id=the-bash-code>The Bash Code</h2><p>In your terminal command, just copy and paste the single command line below:</p><p>Go to your parent folder like <code>Public</code> and create a file using your favorite editor.</p><pre tabindex=0><code>nano backup-script.sh
</code></pre><p>Copy and Paste below:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=c1>##</span>
</span></span><span class=line><span class=cl><span class=c1># ./backup-files SOURCE DESTINATION</span>
</span></span><span class=line><span class=cl><span class=c1># (2) PARAMETERS required, destination where to save</span>
</span></span><span class=line><span class=cl><span class=c1># backup files and target files to backup</span>
</span></span><span class=line><span class=cl><span class=c1># .log File is in destination folder</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># Pre-requisite: tar, tee, head, xargs, gzip</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># Make it executable</span>
</span></span><span class=line><span class=cl><span class=c1># chmod u+x ./backup-files.sh</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1>##</span>
</span></span><span class=line><span class=cl><span class=nv>START</span><span class=o>=</span><span class=k>$(</span>date +%s<span class=k>)</span>
</span></span><span class=line><span class=cl><span class=nv>LOGS</span><span class=o>=</span><span class=k>$(</span>date <span class=s1>&#39;+%m-%d-%Y %H:%M:%S&#39;</span><span class=k>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> -z <span class=s2>&#34;</span><span class=nv>$1</span><span class=s2>&#34;</span> <span class=o>]</span> <span class=o>||</span> <span class=o>[</span> -z <span class=s2>&#34;</span><span class=nv>$2</span><span class=s2>&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=nv>LOGS</span><span class=o>+=</span><span class=s2>&#34; - ERROR: (2) PARAMS required&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nb>echo</span> <span class=nv>$LOGS</span>
</span></span><span class=line><span class=cl>        <span class=nb>echo</span> <span class=s2>&#34;usage:&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nb>echo</span> <span class=s2>&#34;./backup-files.sh SOURCE_FOLDER DESTINATION_FOLDER&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nb>echo</span> <span class=s2>&#34;SOURCE_FOLDER - file source to be added in the archive&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nb>echo</span> <span class=s2>&#34;DESTINATION_FOLDER - file destination to where the archive.tar.gz is saved&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nb>echo</span> <span class=s2>&#34;e.g.&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nb>echo</span> <span class=s2>&#34;./backup-files.sh /home/username/public_hmtl /home/username/backup&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nb>exit</span> 255<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#PARAMS</span>
</span></span><span class=line><span class=cl><span class=nv>DEBUG</span><span class=o>=</span><span class=nb>false</span> <span class=c1>#Bolean</span>
</span></span><span class=line><span class=cl><span class=nv>KEEP_FILES</span><span class=o>=</span><span class=m>5</span> <span class=c1>#Only keep 5 recent files; 0 to disable</span>
</span></span><span class=line><span class=cl><span class=nv>SOURCE_FOLDER</span><span class=o>=</span><span class=nv>$1</span> <span class=c1># SOURCE_FOLDER=&#34;backup-source backup-another-source&#34; #the folder that contains the files that we want to backup</span>
</span></span><span class=line><span class=cl><span class=nv>BACKUP_FOLDER</span><span class=o>=</span><span class=nv>$2</span>
</span></span><span class=line><span class=cl><span class=nv>CWD</span><span class=o>=</span><span class=k>$(</span><span class=nb>pwd</span><span class=k>)</span> <span class=c1># assigning Current Working Directory (CWD)</span>
</span></span><span class=line><span class=cl><span class=c1>#Database Exports</span>
</span></span><span class=line><span class=cl><span class=c1># Note: No whitespace in the -p Flag</span>
</span></span><span class=line><span class=cl><span class=c1># Warining: Careful of hard coded credentials</span>
</span></span><span class=line><span class=cl><span class=c1>#mysqldump -u username -p&#39;SecurePassword&#39; DatabaseName | gzip &gt; /home/username/www/public/backup/DatabaseName_`date +\%m-\%d-\%Y_\%H:\%M`.sql.gz</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Preinstalls --&gt; For testing purpose only; delete this</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[[</span> <span class=s2>&#34;</span><span class=si>${</span><span class=nv>DEBUG</span><span class=si>}</span><span class=s2>&#34;</span> <span class=o>==</span> <span class=s2>&#34;true&#34;</span> <span class=o>]]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;---START Preinstall----&#34;</span>
</span></span><span class=line><span class=cl>    mkdir -p <span class=nv>$SOURCE_FOLDER</span> <span class=o>&amp;&amp;</span> <span class=nb>cd</span> <span class=nv>$SOURCE_FOLDER</span> <span class=c1>#</span>
</span></span><span class=line><span class=cl>    <span class=nv>SOURCE_FOLDER</span><span class=o>=</span><span class=k>$(</span><span class=nb>pwd</span><span class=k>)</span> <span class=c1># Re-assigning to absolute path</span>
</span></span><span class=line><span class=cl>    mkdir -p new-folder
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;This is file 1&#34;</span> <span class=p>|</span> tee -a ./file1.txt &gt;/dev/null 2&gt;<span class=p>&amp;</span><span class=m>1</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;&lt;h2&gt;This is file 2&lt;/h2&gt;&#34;</span> <span class=p>|</span> tee -a ./file2.html &gt;/dev/null 2&gt;<span class=p>&amp;</span><span class=m>1</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;&lt;h3&gt;This is file 3&lt;/h3&gt;&#34;</span> <span class=p>|</span> tee -a ./new-folder/file3.htm &gt;/dev/null 2&gt;<span class=p>&amp;</span><span class=m>1</span>
</span></span><span class=line><span class=cl>    <span class=nb>pwd</span> <span class=o>&amp;&amp;</span> ls
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> -e <span class=s2>&#34;---END Preinstall---- \r\n&#34;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=c1>## End of preinstall --&gt; delete until here.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Check if Source Folder is not empty</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> ! -d <span class=nv>$SOURCE_FOLDER</span> <span class=o>]</span> <span class=o>||</span> <span class=o>[</span> -z <span class=s2>&#34;</span><span class=k>$(</span>ls -A <span class=nv>$SOURCE_FOLDER</span><span class=k>)</span><span class=s2>&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;error: SOURCE FOLDER is empty&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>exit</span> 255<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># The following is path correction for supposedly accuracy</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span> <span class=nv>$SOURCE_FOLDER</span> <span class=o>&amp;&amp;</span> <span class=nv>SOURCE_FOLDER</span><span class=o>=</span><span class=k>$(</span><span class=nb>pwd</span><span class=k>)</span> <span class=c1># Re-assigning to absolute path</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span> <span class=nv>$CWD</span> <span class=o>&amp;&amp;</span> mkdir -p <span class=nv>$BACKUP_FOLDER</span> <span class=c1># Create backup folder if not available</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span> <span class=nv>$BACKUP_FOLDER</span> <span class=o>&amp;&amp;</span> <span class=nv>BACKUP_FOLDER</span><span class=o>=</span><span class=k>$(</span><span class=nb>pwd</span><span class=k>)</span> <span class=c1># Re-assigning to absolute path</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>FOLDERNAME</span><span class=o>=</span><span class=s2>&#34;&#34;</span> <span class=c1># we don&#39;t know yet</span>
</span></span><span class=line><span class=cl><span class=nv>TRIMPATH</span><span class=o>=</span><span class=s2>&#34;[^\/]+</span>$<span class=s2>&#34;</span> <span class=c1># capture the backup folder name only</span>
</span></span><span class=line><span class=cl><span class=c1># Trim function</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[[</span> <span class=nv>$BACKUP_FOLDER</span> <span class=o>=</span>~ <span class=nv>$TRIMPATH</span> <span class=o>]]</span><span class=p>;</span> <span class=k>then</span> <span class=nv>FOLDERNAME</span><span class=o>=</span><span class=si>${</span><span class=nv>BASH_REMATCH</span><span class=p>[0]</span><span class=si>}</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>BACKUPDATE</span><span class=o>=</span><span class=sb>`</span>date +%b-%d-%Y<span class=sb>`</span> <span class=c1>#get the current date #replace this path</span>
</span></span><span class=line><span class=cl><span class=nv>BACKUP_FILE</span><span class=o>=</span><span class=nv>$BACKUP_FOLDER</span>/backup-<span class=nv>$BACKUPDATE</span>.tar.gz
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Remove older backups first</span>
</span></span><span class=line><span class=cl><span class=c1># Check if file if exists</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=nv>$KEEP_FILES</span> !<span class=o>=</span> <span class=m>0</span> <span class=o>]</span> <span class=o>&amp;&amp;</span> <span class=o>[</span> -d <span class=nv>$BACKUP_FOLDER</span> <span class=o>]</span> <span class=o>&amp;&amp;</span> <span class=o>[</span> -n <span class=s2>&#34;</span><span class=k>$(</span>ls -A <span class=nv>$BACKUP_FOLDER</span><span class=k>)</span><span class=s2>&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=c1># Only keep 5 recent backup files</span>
</span></span><span class=line><span class=cl>    <span class=nv>LOGS</span><span class=o>+=</span><span class=s2>&#34;</span><span class=k>$(</span>ls -tr <span class=nv>$BACKUP_FOLDER</span>/backup-*.tar.gz <span class=p>|</span> head -n -<span class=nv>$KEEP_FILES</span> <span class=p>|</span> xargs --no-run-if-empty rm<span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Avoid duplicate backup if exist</span>
</span></span><span class=line><span class=cl><span class=o>[</span> -f <span class=s2>&#34;</span><span class=nv>$BACKUP_FILE</span><span class=s2>&#34;</span> <span class=o>]</span> <span class=o>&amp;&amp;</span> rm <span class=nv>$BACKUP_FILE</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>cd</span> <span class=nv>$SOURCE_FOLDER</span> <span class=c1># Change Directory to avoid &#34;tar: Removing leading `/&#39; from member names&#34; error</span>
</span></span><span class=line><span class=cl><span class=nv>LOGS</span><span class=o>+=</span><span class=s2>&#34;- Backup is running.. &#34;</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[[</span> <span class=s2>&#34;</span><span class=si>${</span><span class=nv>DEBUG</span><span class=si>}</span><span class=s2>&#34;</span> <span class=o>==</span> <span class=s2>&#34;true&#34;</span> <span class=o>]]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=nv>LOGS</span><span class=o>+=</span><span class=s2>&#34;</span><span class=k>$(</span>tar --exclude<span class=o>=</span>*/<span class=nv>$FOLDERNAME</span> -zvcf <span class=nv>$BACKUP_FILE</span> .<span class=k>)</span><span class=s2>&#34;</span> <span class=c1>#create the backup, just add -v flag for verbose</span>
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>    <span class=nv>LOGS</span><span class=o>+=</span><span class=s2>&#34;</span><span class=k>$(</span>tar --exclude<span class=o>=</span>*/<span class=nv>$FOLDERNAME</span> -zcf <span class=nv>$BACKUP_FILE</span> .<span class=k>)</span><span class=s2>&#34;</span> <span class=c1># non-verbose</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>END</span><span class=o>=</span><span class=k>$(</span>date +%s<span class=k>)</span>
</span></span><span class=line><span class=cl><span class=nv>DIFF</span><span class=o>=</span><span class=k>$((</span> <span class=nv>$END</span> <span class=o>-</span> <span class=nv>$START</span> <span class=k>))</span>
</span></span><span class=line><span class=cl><span class=nv>LOGS</span><span class=o>+=</span><span class=s2>&#34;It took </span><span class=nv>$DIFF</span><span class=s2> second to backups.&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Printing logs</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> -e <span class=nv>$LOGS</span> <span class=p>|</span> tee -a <span class=nv>$BACKUP_FOLDER</span>/backup0.log &gt;/dev/null 2&gt;<span class=p>&amp;</span><span class=m>1</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=nv>$LOGS</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Debug results</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[[</span> <span class=s2>&#34;</span><span class=si>${</span><span class=nv>DEBUG</span><span class=si>}</span><span class=s2>&#34;</span> <span class=o>==</span> <span class=s2>&#34;true&#34;</span> <span class=o>]]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;---Start Debug Extract---&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>cd</span> <span class=nv>$BACKUP_FOLDER</span> <span class=o>&amp;&amp;</span> <span class=nb>pwd</span> <span class=o>&amp;&amp;</span> ls -lah
</span></span><span class=line><span class=cl>    tar -xvf backup-<span class=nv>$BACKUPDATE</span>.tar.gz &gt;/dev/null 2&gt;<span class=p>&amp;</span><span class=m>1</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> -e <span class=s2>&#34;\r-- Files from Extracted from backup-</span><span class=nv>$BACKUPDATE</span><span class=s2>.tar.gz --&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>pwd</span> <span class=o>&amp;&amp;</span> ls -lah
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> -e <span class=s2>&#34;\r-- Log File --&#34;</span>
</span></span><span class=line><span class=cl>    cat backup0.log
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;---End Debug Extract---&#34;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=nb>exit</span> <span class=m>0</span>
</span></span></code></pre></div><p>Note: To test the code above, just run this code on <a href=https://www.jdoodle.com/test-bash-shell-script-online/ target=_blank rel="noopener noreffer">jdoodle.com</a> but set DEBUG=true</p><blockquote><p>Command Line Arguments:</p></blockquote><p>./backup-script.sh home/username/backup /home/username/public_hmtl</p><blockquote><p>Important: DEBUG=true</p></blockquote><p>This could be boring, but this is an awesome script (quote and quote) 😀</p><h2 id=executing-the-backup-script>Executing the Backup Script</h2><p>Make the file executable by a current user (your self) running terminal command below:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>chmod u+x ./backup-script.sh
</span></span></code></pre></div><h3 id=automation>Automation</h3><p>Make the backup script executable for the current user (as yourself) by running the terminal command below:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>crontab -e
</span></span></code></pre></div><p>Choose your favorite code editor, I suggest choosing <code>nano</code> editor for simplicity.</p><p>Add the cron job code at the very last line.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=m>0</span> <span class=m>1</span> * * <span class=m>0</span> ~/public/backup-script.sh ~/public/Documents ~/public/Backup &gt;&gt; ~/public/cron.all.log 2&gt;<span class=p>&amp;</span><span class=m>1</span>
</span></span></code></pre></div><p>This will run every “At 01:00 on Sunday.” To play around with the cron scheduler, try and test with <a href=https://crontab.guru/ target=_blank rel="noopener noreffer">crontab.guru</a> is highly recommended.</p><p><code>0 1 * * 0</code> – weekly basis</p><p><code>0 8 * * *</code> – daily basis at 08:00am</p><h3 id=manually-situational>Manually (Situational)</h3><p>You can also manually use this script by running..</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>./backup-script.sh ~/public/Documents ~/public/Backup
</span></span></code></pre></div><h2 id=recommendations>Recommendations</h2><p>Generating database backup files must come first before invoking this backup script. In the next topic, let’s talk about “How to automatically backup your SQL database”.</p><h2 id=disclaimer>Disclaimer</h2><p>This script is well tested in the production environment or real-world scenario and carefully written to prevent any unnecessary bugs or outcomes. However, I am not liable for any issues that this script may cause you. But feel free to drop your comments below if you have questions, suggestions, or recommendations. I would appreciate it. Thank you!</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2023-03-13</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://www.datacareph.com/blog/posts/automatically-backup-files-your-server-files/ data-title="Auto Generating Backup Files for your Linux Server" data-via=datacareph data-hashtags=linux,server,backup,bash><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://www.datacareph.com/blog/posts/automatically-backup-files-your-server-files/ data-hashtag=linux><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://www.datacareph.com/blog/posts/automatically-backup-files-your-server-files/ data-title="Auto Generating Backup Files for your Linux Server"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://www.datacareph.com/blog/posts/automatically-backup-files-your-server-files/ data-title="Auto Generating Backup Files for your Linux Server"><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://www.datacareph.com/blog/posts/automatically-backup-files-your-server-files/ data-title="Auto Generating Backup Files for your Linux Server"><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/blog/tags/linux/>linux</a>,&nbsp;<a href=/blog/tags/server/>server</a>,&nbsp;<a href=/blog/tags/backup/>backup</a>,&nbsp;<a href=/blog/tags/bash/>bash</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/blog/>Home</a></span></section></div><div class=post-nav><a href=/blog/posts/breach-threat-someone-can-peek-your-saved-password-from-the-browser/ class=prev rel=prev title="Breach Threat! Someone Can Reveal Your Saved Password from the Browser"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Breach Threat! Someone Can Reveal Your Saved Password from the Browser</a>
<a href=/blog/posts/redirects-non-www-to-www-using-cloudflare/ class=next rel=next title="Redirect Non-WWW to WWW using Cloudflare as Clean Solution For Traefik: Step-by-Step Guide.">Redirect Non-WWW to WWW using Cloudflare as Clean Solution For Traefik: Step-by-Step Guide.<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=disqus_thread class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://disqus.com/?ref_noscript>Disqus</a>.</noscript><div id=fb-root class=comment></div><div class=fb-comments data-href=https://www.datacareph.com/blog/posts/automatically-backup-files-your-server-files/ data-width=100% data-numposts=10></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://developers.facebook.com/docs/plugins/comments/></a>Facebook</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><div class=share-the-love>Share the knowledge with &#9829;</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2015 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/blog/ target=_blank>researchcare</a></span>&nbsp;|&nbsp;<span class=license><a rel=license href=http://creativecommons.org/licenses/by/4.0/><img alt="Creative Commons License" style=border-width:0 src=https://i.creativecommons.org/l/by/4.0/80x15.png></a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lightgallery@2.7.1/css/lightgallery-bundle.min.css><script type=text/javascript src=https://datacareph.disqus.com/embed.js defer></script><script type=text/javascript src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v5.0&appId=159208386942987&autoLogAppEvents=1" defer></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/algoliasearch@4.13.1/dist/algoliasearch-lite.umd.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.7.1/lightgallery.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},lightgallery:!0,search:{algoliaAppID:"CFS0IGKQ6V",algoliaIndex:"prod_Blog",algoliaSearchKey:"71f9ddb95d3ec317e4023b4baea18787",highlightTag:"em",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"algolia"}}</script><script type=text/javascript src=/blog/js/theme.min.js></script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=G-QDVFK27GYE" async></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-QDVFK27GYE",{anonymize_ip:!0})</script></body></html>